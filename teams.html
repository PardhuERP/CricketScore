<script>
const API_URL =
"https://script.google.com/macros/s/AKfycbzdz3UnRjf-nDbzd9WCdKpQG32jXc1ehGKeXy9q_Czm8ASwHSszmvWlNQa8OSL-6VE/exec";

/* ===== JSONP: LOAD TEAMS ===== */
function loadTeams(){
  const list = document.getElementById("teamsList");
  list.innerText = "Loading teams...";

  const cb = "cb_" + Date.now();
  window[cb] = function(data){
    list.innerHTML = "";
    if(!data || data.length === 0){
      list.innerText = "No teams created yet";
    }else{
      data.forEach(t=>{
        const d = document.createElement("div");
        d.className = "team";
        d.innerText = "üèè " + t;
        list.appendChild(d);
      });
    }
    delete window[cb];
  };

  const s = document.createElement("script");
  s.src = API_URL + "?action=getTeams&callback=" + cb;
  document.body.appendChild(s);
}

/* ===== JSONP: CREATE TEAM ===== */
function createTeam(){
  const name = document.getElementById("teamName").value.trim();
  const msg = document.getElementById("msg");

  if(!name){
    msg.innerText = "‚ö†Ô∏è Enter team name";
    msg.style.color = "orange";
    return;
  }

  const cb = "cb_create_" + Date.now();
  window[cb] = function(res){
    if(res.status === "ok"){
      msg.innerText = "‚úÖ Team created";
      msg.style.color = "green";
      document.getElementById("teamName").value="";
      loadTeams();
    }else{
      msg.innerText = "‚ùå Error creating team";
      msg.style.color = "red";
    }
    delete window[cb];
  };

  const s = document.createElement("script");
  s.src = API_URL +
    "?action=createTeam" +
    "&teamName=" + encodeURIComponent(name) +
    "&callback=" + cb;

  document.body.appendChild(s);
}

window.onload = loadTeams;
</script>
