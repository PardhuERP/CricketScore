<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Batting & Bowling Stats</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f2f4f8;
}
.header{
  background:#0a7cff;
  color:#fff;
  padding:14px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
}
.container{ padding:16px; }

.card{
  background:#fff;
  border-radius:14px;
  padding:14px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th, td{
  padding:8px;
  border-bottom:1px solid #eee;
  text-align:center;
}
th{
  background:#f7f7f7;
  font-weight:bold;
}
.title{
  font-weight:bold;
  margin-bottom:8px;
}
.note{
  font-size:13px;
  color:#666;
  margin-top:6px;
}
</style>
</head>

<body>

<div class="header">üìä Batting & Bowling Stats</div>

<div class="container">

  <!-- BATTING -->
  <div class="card">
    <div class="title">üèè Batting</div>
    <table>
      <thead>
        <tr>
          <th>Player</th>
          <th>R</th>
          <th>B</th>
          <th>4s</th>
          <th>6s</th>
          <th>SR</th>
        </tr>
      </thead>
      <tbody id="battingTable">
        <tr><td colspan="6">Loading‚Ä¶</td></tr>
      </tbody>
    </table>
  </div>

  <!-- BOWLING -->
  <div class="card">
    <div class="title">üéØ Bowling</div>
    <table>
      <thead>
        <tr>
          <th>Bowler</th>
          <th>O</th>
          <th>R</th>
          <th>W</th>
          <th>Econ</th>
        </tr>
      </thead>
      <tbody id="bowlingTable">
        <tr><td colspan="5">Loading‚Ä¶</td></tr>
      </tbody>
    </table>
  </div>

</div>

<script>
/* üîí FINAL & FOREVER API URL */
const API_URL =
  "https://script.google.com/macros/s/AKfycbzdz3UnRjf-nDbzd9WCdKpQG32jXc1ehGKeXy9q_Czm8ASwHSszmvWlNQa8OSL-6VE/exec";

function loadStats(){
  fetch(API_URL + "?action=getStats")
    .then(res => res.json())
    .then(d => {

      /* üèè Batting */
      const bat = document.getElementById("battingTable");
      bat.innerHTML = "";

      if(!d.batting || d.batting.length === 0){
        bat.innerHTML = "<tr><td colspan='6'>No batting data</td></tr>";
      }else{
        d.batting.forEach(p=>{
          const balls = Number(p.balls) || 0;
          const runs  = Number(p.runs) || 0;
          const sr = balls > 0 ? ((runs / balls) * 100).toFixed(1) : "0.0";

          bat.innerHTML += `
            <tr>
              <td>${p.name}</td>
              <td>${runs}</td>
              <td>${balls}</td>
              <td>${p.fours}</td>
              <td>${p.sixes}</td>
              <td>${sr}</td>
            </tr>`;
        });
      }

      /* üéØ Bowling */
      const bowl = document.getElementById("bowlingTable");
      bowl.innerHTML = "";

      if(!d.bowling || d.bowling.length === 0){
        bowl.innerHTML = "<tr><td colspan='5'>No bowling data</td></tr>";
      }else{
        d.bowling.forEach(b=>{
          const overs = Number(b.overs) || 0;
          const runs  = Number(b.runs) || 0;
          const econ = overs > 0 ? (runs / overs).toFixed(1) : "0.0";

          bowl.innerHTML += `
            <tr>
              <td>${b.name}</td>
              <td>${overs}</td>
              <td>${runs}</td>
              <td>${b.wickets}</td>
              <td>${econ}</td>
            </tr>`;
        });
      }

    })
    .catch(()=>{
      document.getElementById("battingTable").innerHTML =
        "<tr><td colspan='6'>‚ùå Error loading stats</td></tr>";
      document.getElementById("bowlingTable").innerHTML =
        "<tr><td colspan='5'>‚ùå Error loading stats</td></tr>";
    });
}

loadStats();
setInterval(loadStats, 5000); // auto refresh every 5 sec
</script>

</body>
</html>
