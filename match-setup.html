<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Match Setup</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#f2f4f8}
.header{background:#0a7cff;color:#fff;padding:14px;text-align:center;font-size:18px}
.card{background:#fff;margin:15px;padding:15px;border-radius:12px}
select,input,button{
  width:100%;padding:12px;margin-top:10px;
  border-radius:8px;border:1px solid #ccc;font-size:15px
}
button{background:#0a7cff;color:#fff;border:none}
</style>
</head>

<body>

<div class="header">üõ†Ô∏è Match Setup</div>
<div class="card">
  <button onclick="dashboard()">‚ñ∂ Back</button>
</div>
  
<div class="card">
  <label>Match Title</label>
  <input id="matchTitle" placeholder="Team A vs Team B">

  <label>Overs Limit</label>
  <select id="overs">
    <option>5</option>
    <option>10</option>
    <option selected>20</option>
  </select>
</div>

<div class="card">
  <label>Batting Team</label>
  <select id="batting"></select>

  <label>Bowling Team</label>
  <select id="bowling"></select>
</div>

<div class="card">
  <label>Striker</label>
  <select id="striker"></select>

  <label>Non-Striker</label>
  <select id="nonstriker"></select>

  <label>Bowler</label>
  <select id="bowler"></select>
</div>

<div class="card">
  <button onclick="startMatch()">‚ñ∂ Start Match</button>
</div>


<script>
const API =
"https://script.google.com/macros/s/AKfycbzdz3UnRjf-nDbzd9WCdKpQG32jXc1ehGKeXy9q_Czm8ASwHSszmvWlNQa8OSL-6VE/exec";

function jsonp(url,cb){
  const s=document.createElement("script");
  s.src=url+"&callback="+cb;
  document.body.appendChild(s);
}

/* Load Teams */
jsonp(API+"?action=getTeams","loadTeams");
function loadTeams(t){
  ["batting","bowling"].forEach(id=>{
    const s=document.getElementById(id);
    s.innerHTML="<option value=''>Select</option>";
    t.forEach(x=>s.innerHTML+=`<option>${x}</option>`);
  });
}

/* Load Players */
["batting","bowling"].forEach(id=>{
  document.getElementById(id).onchange=()=>{
    const team=document.getElementById(id).value;
    if(!team) return;
    jsonp(API+"?action=getPlayers&team="+team,id+"Players");
  };
});

function battingPlayers(p){
  fill(["striker","nonstriker"],p);
}
function bowlingPlayers(p){
  fill(["bowler"],p);
}
function fill(ids,p){
  ids.forEach(id=>{
    const s=document.getElementById(id);
    s.innerHTML="<option value=''>Select</option>";
    p.forEach(x=>s.innerHTML+=`<option>${x.name}</option>`);
  });
}

/* START MATCH */
function startMatch(){
  const q =
    "?action=startMatch"+
    "&match="+matchTitle.value+
    "&batting="+batting.value+
    "&bowling="+bowling.value+
    "&overs="+overs.value+
    "&striker="+striker.value+
    "&nonstriker="+nonstriker.value+
    "&bowler="+bowler.value;

  jsonp(API+q,"done");
}

function done(){
  location.href="score-entry.html";
}
</script>

</body>
</html>
