<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Partnerships</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f2f4f8;
}
.header{
  background:#0a7cff;
  color:#fff;
  padding:14px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
}
.container{ padding:16px; }

.card{
  background:#fff;
  border-radius:14px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
}

.big{
  font-size:28px;
  font-weight:bold;
}
.sub{
  color:#666;
  margin-top:4px;
  font-size:14px;
}
.row{
  display:flex;
  justify-content:space-between;
  margin-top:8px;
  font-size:14px;
}
.tag{
  display:inline-block;
  padding:3px 8px;
  border-radius:6px;
  font-size:12px;
  background:#e0f2ff;
  color:#0a7cff;
}
.ended{ background:#eee; }
</style>
</head>

<body>

<div class="header">ü§ù Partnerships</div>

<div class="container">

  <!-- ACTIVE PARTNERSHIP -->
  <div class="card" id="activeCard">
    <div class="big" id="pair">Loading‚Ä¶</div>
    <div class="sub" id="rr">‚Äî</div>

    <div class="row">
      <span>Runs</span>
      <strong id="runs">‚Äî</strong>
    </div>
    <div class="row">
      <span>Balls</span>
      <strong id="balls">‚Äî</strong>
    </div>
    <div class="row">
      <span>Start Over</span>
      <strong id="start">‚Äî</strong>
    </div>

    <div class="tag">ACTIVE</div>
  </div>

  <!-- ALL PARTNERSHIPS -->
  <div class="card">
    <h3>All Partnerships</h3>
    <div id="list">Loading‚Ä¶</div>
  </div>

</div>

<script>
const API_URL =
"https://script.google.com/macros/s/AKfycbzdz3UnRjf-nDbzd9WCdKpQG32jXc1ehGKeXy9q_Czm8ASwHSszmvWlNQa8OSL-6VE/exec";

/* ===== LOAD PARTNERSHIPS (JSONP) ===== */
function loadPartnerships(){
  const cb = "cb_part_" + Date.now();

  window[cb] = function(data){
    render(data || []);
    delete window[cb];
  };

  const s = document.createElement("script");
  s.src = API_URL + "?action=getPartnership&callback=" + cb;
  document.body.appendChild(s);
}

function render(data){
  const active = data.find(p => p.status === "ACTIVE");
  const list = document.getElementById("list");

  /* ACTIVE */
  if(active){
    document.getElementById("pair").innerText = active.batsmen;
    document.getElementById("runs").innerText = active.runs;
    document.getElementById("balls").innerText = active.balls;
    document.getElementById("start").innerText = active.startOver;

    const rr = active.balls > 0
      ? ((active.runs / active.balls) * 6).toFixed(2)
      : "0.00";

    document.getElementById("rr").innerText = "Run Rate: " + rr;
  }else{
    document.getElementById("activeCard").innerHTML =
      "<div>No active partnership</div>";
  }

  /* LIST */
  list.innerHTML = "";
  if(data.length === 0){
    list.innerText = "No partnerships yet";
    return;
  }

  data.slice().reverse().forEach(p=>{
    const div = document.createElement("div");
    div.style.padding = "10px 0";
    div.style.borderBottom = "1px solid #eee";
    div.innerHTML = `
      <strong>${p.batsmen}</strong><br>
      ${p.runs} runs (${p.balls} balls) |
      ${p.startOver} ‚Äì ${p.endOver || "‚Ä¶"}
      <span class="tag ${p.status==="ENDED"?"ended":""}">
        ${p.status}
      </span>
    `;
    list.appendChild(div);
  });
}

/* AUTO REFRESH */
loadPartnerships();
setInterval(loadPartnerships, 5000);
</script>

</body>
</html>
